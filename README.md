# Slack Task Notifier for Google Sheets
詳細は [Notion:タスク自動通知の処理仕様/利用手順](https://www.notion.so/superstudio-pe/22aa2a12137b80138804d2ced7dce5cf?source=copy_link&utm_content=22aa2a12-137b-8013-8804-d2ced7dce5cf&utm_campaign=T6L1K6VTR&n=slack&n=slack_link_unfurl&pvs=6)を確認してください。

-----

  - **期限切れタスクの通知**: WBSシートから終了日を過ぎた未完了タスクを抽出して通知します。
  - **週間タスクの通知**: WBSシートから今週開始予定のタスクを抽出して通知します。
  - **未完了TODOの通知**: TODO管理シートから残っているタスクを一覧で通知します。
  - **未完了課題の通知**: 課題管理シートから未解決の課題を一覧で通知します。
  - **ダイレクトリンク**: 通知内の行番号をクリックすると、該当のスプレッドシートの行に直接遷移できます。

## 導入手順

### 1\. スプレッドシートの準備

  - WBSシートの雛形のコピーします。
  - ※シート名は雛形から変更しないでください。（スクリプトが実行できなくなります）
    
### 2\. Google Apps Scriptの設定

  - 準備したスプレッドシートで、`拡張機能` \> `Apps Script` を選択し、スクリプトエディタを開きます。
  - このリポジトリにあるコードをすべてコピーし、スクリプトエディタに貼り付けます。
  - `Cmd + S` でプロジェクトを保存します。

### 3\. Slack Webhook URLの取得と設定

  - SlackでIncoming Webhookアプリを追加し、通知したいチャンネルを選択してWebhook URLを生成します。
  - スクリプトの`CONFIG`オブジェクト内にある`SLACK_WEBHOOK_URL`の値を、取得したURLに書き換えます。

<!-- end list -->

```javascript
const CONFIG = {
  // ...
  // ⚠️🔻【要設定】ここにSlackのWebhook URLを貼り付けてください！ 🔻⚠️
  SLACK_WEBHOOK_URL: "ここに取得したURLを貼り付ける",
  // ...
};
```

-----

## 実行方法

### 手動実行（テスト）

1.  スクリプトエディタの上部にある関数選択プルダウンで`checkTasksAndNotifySlack`を選びます。
2.  `実行`ボタンをクリックします。
3.  初回実行時には、Googleアカウントへのアクセス許可を求めるポップアップが表示されるので、内容を確認して承認してください。
4.  設定したSlackチャンネルに通知が届けば成功です（Slack通知したくない場合は、Webhook URLを設定しないでください）。

### 自動実行

1.  スクリプトエディタの左側にあるメニューから`トリガー`（時計のアイコン）を選択します。
2.  右下の`トリガーを追加`ボタンをクリックします。
3.  以下の通りに設定し、`保存`をクリックします。
      - **実行する関数を選択**: `checkTasksAndNotifySlack`
      - **実行するデプロイを選択**: `Head`
      - **イベントのソースを選択**: `時間主導型`
      - **時間ベースのトリガーのタイプを選択**: `週タイマー`（または`日タイマー`など）
      - **時刻を選択**: `午前9時～10時`など、通知したい時間帯を選択します。

これで、毎日指定した時間になるとスクリプトが自動で実行され、Slackに通知が届くようになります。

-----
